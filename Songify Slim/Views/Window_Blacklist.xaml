<controls:MetroWindow
    x:Class="Songify_Slim.Views.Window_Blacklist"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Songify_Slim.Properties"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:userControls="clr-namespace:Songify_Slim.UserControls"
    Title="{DynamicResource WinTitle_Blocklist}"
    Width="658"
    Height="506"
    d:Title="{i18n:Loc WinTitle_Blocklist}"
    WindowStartupLocation="CenterOwner"
    WindowStyle="ToolWindow"
    mc:Ignorable="d">
    <controls:MetroWindow.Resources>
        <mah:CustomDialog
            x:Key="ArtistPickerDialog"
            Title="Select Artist"
            KeyDown="ArtistPickerDialog_OnKeyDown">
            <mah:CustomDialog.Content>
                <Grid
                    MaxHeight="420"
                    Margin="10"
                    VerticalAlignment="Stretch">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock
                        Grid.Row="0"
                        Opacity="0.75"
                        Text="Multiple artists matched your search. Select one to block." />

                    <DataGrid
                        Grid.Row="1"
                        Margin="0,10,0,10"
                        AutoGenerateColumns="False"
                        Background="{DynamicResource MahApps.Brushes.Control.Background}"
                        CanUserAddRows="False"
                        Foreground="{DynamicResource MahApps.Brushes.IdealForeground}"
                        IsReadOnly="True"
                        ItemsSource="{Binding ArtistPickerItems}"
                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                        SelectedItem="{Binding SelectedArtistPickerItem, Mode=TwoWay}"
                        SelectionMode="Single"
                        SelectionUnit="FullRow">
                        <DataGrid.RowStyle>
                            <Style BasedOn="{StaticResource MahApps.Styles.DataGridRow}" TargetType="DataGridRow">
                                <EventSetter Event="MouseDoubleClick" Handler="ArtistsRow_DoubleClick" />
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTextColumn
                                Width="50"
                                Binding="{Binding Num}"
                                Header="#" />
                            <DataGridTextColumn
                                Width="*"
                                Binding="{Binding Artist}"
                                Header="Artist" />
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel
                        Grid.Row="2"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal">
                        <Button
                            MinWidth="100"
                            Margin="0,0,10,0"
                            Click="ArtistDialog_Close_Click"
                            Content="Close" />
                        <Button
                            MinWidth="140"
                            Click="ArtistDialog_Select_Click"
                            Content="Block selected" />
                    </StackPanel>
                </Grid>
            </mah:CustomDialog.Content>
        </mah:CustomDialog>
        <mah:CustomDialog x:Key="ArtistResolveDialog" Title="Resolve artist ID">
            <mah:CustomDialog.Content>
                <Grid
                    Width="560"
                    MaxHeight="440"
                    Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock
                        Grid.Row="0"
                        Opacity="0.75"
                        Text="{Binding ResolveDialogHint}" />

                    <DataGrid
                        Grid.Row="1"
                        Margin="0,10,0,10"
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        IsReadOnly="True"
                        ItemsSource="{Binding ResolveCandidates}"
                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                        SelectedItem="{Binding SelectedResolveCandidate, Mode=TwoWay}"
                        SelectionMode="Single"
                        SelectionUnit="FullRow">

                        <!--  Keep MahApps selection visuals  -->
                        <DataGrid.RowStyle>
                            <Style BasedOn="{StaticResource MahApps.Styles.DataGridRow}" TargetType="DataGridRow">
                                <EventSetter Event="MouseDoubleClick" Handler="ResolveRow_DoubleClick" />
                            </Style>
                        </DataGrid.RowStyle>

                        <DataGrid.Columns>
                            <DataGridTextColumn
                                Width="*"
                                Binding="{Binding Name}"
                                Header="Artist" />
                            <DataGridTextColumn
                                Width="260"
                                Binding="{Binding Id}"
                                Header="Id" />
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel
                        Grid.Row="2"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal">
                        <Button
                            MinWidth="90"
                            Margin="0,0,10,0"
                            Click="Resolve_Skip_Click"
                            Content="Skip" />

                        <Button
                            MinWidth="120"
                            Click="Resolve_UseSelected_Click"
                            Content="Use selected" />
                    </StackPanel>
                </Grid>
            </mah:CustomDialog.Content>
        </mah:CustomDialog>
    </controls:MetroWindow.Resources>

    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Header / hint  -->
        <StackPanel Grid.Row="0" Margin="0,0,0,10">
            <TextBlock
                Margin="0,4,0,0"
                Opacity="0.75"
                Text="Block artists, songs, or users from being requested. Artist and Songs only work for Spotify!" />
        </StackPanel>

        <controls:MetroAnimatedTabControl
            x:Name="BlacklistTabs"
            Grid.Row="1"
            TabStripPlacement="Top">

            <!--  ===================== ARTISTS =====================  -->
            <controls:MetroTabItem Header="Artists">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Add row  -->
                    <Grid Grid.Row="0" Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBox
                            x:Name="ArtistInput"
                            Grid.Column="0"
                            Margin="0,0,10,0"
                            KeyDown="ArtistInput_KeyDown" />

                        <Button
                            Grid.Column="1"
                            MinWidth="90"
                            Click="AddArtist_Click"
                            Content="Add" />
                    </Grid>

                    <!--  List  -->
                    <ListBox
                        x:Name="ArtistList"
                        Grid.Row="1"
                        Margin="0,0,0,10"
                        ScrollViewer.VerticalScrollBarVisibility="Auto">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <!--  Reusable row control  -->
                                <userControls:UC_BlacklistEntry Loaded="ArtistEntry_Loaded" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                        <ListBox.ItemContainerStyle>
                            <Style BasedOn="{StaticResource {x:Type ListBoxItem}}" TargetType="ListBoxItem">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Id}" Value="">
                                        <Setter Property="Foreground" Value="IndianRed" />
                                        <Setter Property="ToolTip" Value="Legacy entry: missing ID. Click Refresh to fix." />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Id}" Value="{x:Null}">
                                        <Setter Property="Foreground" Value="IndianRed" />
                                        <Setter Property="ToolTip" Value="Legacy entry: missing ID. Click Refresh to fix." />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                    </ListBox>

                    <!--  Footer actions  -->
                    <DockPanel Grid.Row="2" LastChildFill="False">
                        <TextBlock
                            VerticalAlignment="Center"
                            DockPanel.Dock="Left"
                            Opacity="0.75"
                            Text="{Binding ElementName=ArtistList, Path=Items.Count, StringFormat={}{0} blocked}" />

                        <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                            <Button
                                MinWidth="120"
                                Margin="0,0,10,0"
                                Click="RefreshArtists_Click"
                                Content="Refresh IDs" />

                            <Button
                                MinWidth="110"
                                Click="ClearArtists_Click"
                                Content="Remove all" />
                        </StackPanel>
                    </DockPanel>
                </Grid>
            </controls:MetroTabItem>

            <!--  ===================== SONGS =====================  -->
            <controls:MetroTabItem Header="Songs">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Add row  -->
                    <Grid Grid.Row="0" Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBox
                            x:Name="SongInput"
                            Grid.Column="0"
                            Margin="0,0,10,0"
                            KeyDown="SongInput_KeyDown" />

                        <Button
                            Grid.Column="1"
                            MinWidth="90"
                            Click="AddSong_Click"
                            Content="Add" />
                    </Grid>

                    <ListBox
                        x:Name="SongList"
                        Grid.Row="1"
                        Margin="0,0,0,10"
                        ScrollViewer.VerticalScrollBarVisibility="Auto">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <userControls:UC_BlacklistEntry Loaded="SongEntry_Loaded" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>

                        <ListBox.ItemContainerStyle>
                            <Style BasedOn="{StaticResource {x:Type ListBoxItem}}" TargetType="ListBoxItem">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Id}" Value="">
                                        <Setter Property="Foreground" Value="IndianRed" />
                                        <Setter Property="ToolTip" Value="Legacy entry: missing ID. Click Refresh to fix." />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Id}" Value="{x:Null}">
                                        <Setter Property="Foreground" Value="IndianRed" />
                                        <Setter Property="ToolTip" Value="Legacy entry: missing ID. Click Refresh to fix." />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                    </ListBox>

                    <DockPanel Grid.Row="2" LastChildFill="False">
                        <TextBlock
                            VerticalAlignment="Center"
                            DockPanel.Dock="Left"
                            Opacity="0.75"
                            Text="{Binding ElementName=SongList, Path=Items.Count, StringFormat={}{0} blocked}" />

                        <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                            <Button
                                MinWidth="110"
                                Click="ClearSongs_Click"
                                Content="Remove all" />
                        </StackPanel>
                    </DockPanel>
                </Grid>
            </controls:MetroTabItem>

            <!--  ===================== USERS =====================  -->
            <controls:MetroTabItem Header="Users">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Add row  -->
                    <Grid Grid.Row="0" Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBox
                            x:Name="UserInput"
                            Grid.Column="0"
                            Margin="0,0,10,0"
                            KeyDown="UserInput_KeyDown" />

                        <Button
                            Grid.Column="1"
                            MinWidth="90"
                            Click="AddUser_Click"
                            Content="Add" />
                    </Grid>

                    <ListBox
                        x:Name="UserList"
                        Grid.Row="1"
                        Margin="0,0,0,10"
                        ScrollViewer.VerticalScrollBarVisibility="Auto">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <userControls:UC_BlacklistEntry Loaded="UserEntry_Loaded" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                        <ListBox.ItemContainerStyle>
                            <Style BasedOn="{StaticResource {x:Type ListBoxItem}}" TargetType="ListBoxItem">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Id}" Value="">
                                        <Setter Property="Foreground" Value="IndianRed" />
                                        <Setter Property="ToolTip" Value="Legacy entry: missing ID. Click Refresh to fix." />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Id}" Value="{x:Null}">
                                        <Setter Property="Foreground" Value="IndianRed" />
                                        <Setter Property="ToolTip" Value="Legacy entry: missing ID. Click Refresh to fix." />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                    </ListBox>

                    <DockPanel Grid.Row="2" LastChildFill="False">
                        <TextBlock
                            VerticalAlignment="Center"
                            DockPanel.Dock="Left"
                            Opacity="0.75"
                            Text="{Binding ElementName=UserList, Path=Items.Count, StringFormat={}{0} blocked}" />

                        <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                            <Button
                                MinWidth="90"
                                Margin="0,0,10,0"
                                Click="RefreshUsers_Click"
                                Content="Refresh user ids" />
                            <Button
                                MinWidth="110"
                                Click="ClearUsers_Click"
                                Content="Remove all" />
                        </StackPanel>
                    </DockPanel>
                </Grid>
            </controls:MetroTabItem>
        </controls:MetroAnimatedTabControl>

        <!--<TextBox
            x:Name="tb_Blacklist"
            Grid.RowSpan="1"
            Height="26"
            Margin="6"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Top"
            KeyDown="Tb_Blacklist_KeyDown"
            TabIndex="1"
            TextWrapping="Wrap" />
        <StackPanel
            Grid.Row="0"
            Grid.Column="2"
            Margin="6"
            HorizontalAlignment="Center"
            Orientation="Horizontal">
            <Button
                x:Name="btn_Add"
                Grid.Column="2"
                Width="81"
                Height="26"
                Margin="0,0,6,0"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                d:Content="{i18n:Loc bw_btnAdd}"
                Click="Btn_Add_Click"
                Content="{DynamicResource bw_btnAdd}"
                TabIndex="3" />
            <Button
                x:Name="btn_Clear"
                Grid.Column="2"
                Width="65"
                Height="26"
                Padding="5,6"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                d:Content="{i18n:Loc bw_btnClear}"
                Click="Btn_Clear_Click"
                Content="{DynamicResource bw_btnClear}"
                Grid.IsSharedSizeScope="True"
                TabIndex="4" />
        </StackPanel>

        <ComboBox
            x:Name="cbx_Type"
            Grid.Row="0"
            Grid.Column="1"
            Margin="6"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Center"
            RenderTransformOrigin="0.5,0.5"
            SelectedIndex="0"
            SelectionChanged="Cbx_Type_SelectionChanged"
            TabIndex="2">
            <ComboBoxItem d:Content="{i18n:Loc bw_cbArtist}" Content="{DynamicResource bw_cbArtist}" />
            <ComboBoxItem d:Content="{i18n:Loc bw_cbUser}" Content="{DynamicResource bw_cbUser}" />
            <ComboBoxItem d:Content="{i18n:Loc s_Song}" Content="{DynamicResource s_Song}" />
        </ComboBox>
        <ListBox
            x:Name="ListView_Blacklist"
            Grid.Row="2"
            Grid.Column="0"
            Margin="6"
            BorderThickness="1"
            KeyDown="ListView_Blacklist_KeyDown">
            <ListBox.ContextMenu>
                <ContextMenu>
                    <MenuItem
                        d:Header="{i18n:Loc bw_menu_Delete}"
                        Click="MenuItem_Click"
                        Header="{DynamicResource bw_menu_Delete}" />
                </ContextMenu>
            </ListBox.ContextMenu>
        </ListBox>
        <ListBox
            x:Name="ListView_UserBlacklist"
            Grid.Row="2"
            Grid.Column="1"
            Margin="6"
            BorderThickness="1"
            KeyDown="ListView_UserBlacklist_KeyDown">
            <ListBox.ContextMenu>
                <ContextMenu>
                    <MenuItem
                        d:Header="{i18n:Loc bw_menu_Delete}"
                        Click="MenuItem_Click"
                        Header="{DynamicResource bw_menu_Delete}" />
                </ContextMenu>
            </ListBox.ContextMenu>
        </ListBox>
        <ListBox
            x:Name="ListView_SongBlacklist"
            Grid.Row="2"
            Grid.Column="2"
            Margin="6"
            BorderThickness="1"
            DisplayMemberPath="ReadableName"
            KeyDown="ListView_SongBlacklist_KeyDown"
            SelectedValuePath="ReadableName">
            <ListBox.ContextMenu>
                <ContextMenu>
                    <MenuItem
                        d:Header="{i18n:Loc bw_menu_Delete}"
                        Click="MenuItem_Click"
                        Header="{DynamicResource bw_menu_Delete}" />
                </ContextMenu>
            </ListBox.ContextMenu>
        </ListBox>
        <Label
            Grid.Row="1"
            Grid.Column="0"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            d:Content="{i18n:Loc bw_lblBlockedArtists}"
            Content="{DynamicResource bw_lblBlockedArtists}" />
        <Label
            Grid.Row="1"
            Grid.Column="1"
            VerticalAlignment="Top"
            d:Content="{i18n:Loc bw_lblBlockedUsers}"
            Content="{DynamicResource bw_lblBlockedUsers}" />
        <Label
            Grid.Row="1"
            Grid.Column="2"
            VerticalAlignment="Top"
            d:Content="{i18n:Loc bw_lblBlockedSongs}"
            Content="{DynamicResource bw_lblBlockedSongs}" />
        <ContentControl
            x:Name="cc_Content"
            Grid.Row="1"
            Grid.RowSpan="2"
            Grid.Column="0"
            Grid.ColumnSpan="3"
            Panel.ZIndex="50"
            Visibility="Collapsed">
            <Grid Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}">
                <TextBlock
                    Width="330"
                    Height="40"
                    Margin="0,10,0,0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Top"
                    FontSize="16"
                    Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                    TextAlignment="Center"
                    TextWrapping="Wrap"><Run Text="The search returned more than one artist. Select one or" /><Run Text=" more to block" /><Run Text="." /></TextBlock>
                <DataGrid
                    x:Name="dgv_Artists"
                    Height="323"
                    Margin="15,55,15,0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Top"
                    CanUserReorderColumns="False"
                    CanUserResizeColumns="False"
                    CanUserSortColumns="False"
                    SelectionMode="Single">
                    <DataGrid.Columns>
                        <DataGridTextColumn
                            Width="25"
                            Binding="{Binding Path=Num}"
                            Header="#"
                            IsReadOnly="True" />
                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding Path=Artist}"
                            Header="Artist"
                            IsReadOnly="True" />
                        <DataGridTemplateColumn Width="auto" IsReadOnly="False">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        IsChecked="{Binding Path=IsSelected, UpdateSourceTrigger=PropertyChanged}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
                <Button
                    x:Name="btn_CancelArtists"
                    Width="86"
                    Margin="245,383,106,10"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Click="Btn_CancelArtists_Click"
                    Content="Cancel" />

                <Button
                    x:Name="btn_AddArtists"
                    Width="86"
                    Margin="336,383,15,10"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Click="Btn_AddArtists_Click"
                    Content="Add selected" />
            </Grid>
        </ContentControl>-->
    </Grid>
</controls:MetroWindow>